<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BuildMyFolio ‚Äî AI Career Studio</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link
    href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <style>
    :root {
      --bg: #06060d;
      --surface: #0e0d19;
      --surface2: #161427;
      --surface3: #1f1b36;
      --border: #302a4d;
      --accent: #b794f6;
      --accent2: #93c5fd;
      --accent3: #c4b5fd;
      --exotic1: #a5b4fc;
      --exotic2: #7dd3fc;
      --exotic3: #c4b5fd;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --text: #ecebff;
      --text2: #bab4db;
      --text3: #8f87b5;
      --glow: rgba(183, 148, 246, 0.22);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'DM Sans', sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Background mesh */
    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background:
        radial-gradient(ellipse 80% 50% at 10% 10%, rgba(183, 148, 246, 0.12) 0%, transparent 60%),
        radial-gradient(ellipse 60% 40% at 90% 80%, rgba(125, 211, 252, 0.09) 0%, transparent 60%),
        radial-gradient(ellipse 40% 40% at 50% 50%, rgba(147, 197, 253, 0.05) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }

    .app {
      position: relative;
      z-index: 1;
    }

    /* ‚îÄ‚îÄ‚îÄ Header ‚îÄ‚îÄ‚îÄ */
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1.25rem 2.5rem;
      border-bottom: 1px solid var(--border);
      background: rgba(8, 8, 14, 0.82);
      backdrop-filter: blur(12px);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .brand-stack {
      display: flex;
      flex-direction: column;
      gap: 0.15rem;
    }

    .logo {
      font-family: 'Syne', sans-serif;
      font-weight: 800;
      font-size: 1.5rem;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: -0.02em;
    }

    .logo span {
      color: var(--accent3);
      -webkit-text-fill-color: var(--accent3);
    }

    .brand-sub {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.68rem;
      letter-spacing: 0.13em;
      text-transform: uppercase;
      color: var(--text3);
    }

    nav {
      display: flex;
      gap: 0.5rem;
    }

    .nav-btn {
      padding: 0.5rem 1rem;
      border-radius: 8px;
      border: none;
      background: transparent;
      color: var(--text2);
      font-family: 'DM Sans', sans-serif;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .nav-btn:hover,
    .nav-btn.active {
      background: rgba(183, 148, 246, 0.12);
      color: var(--accent);
    }

    .nav-btn.active {
      color: var(--accent);
      border-bottom: 2px solid var(--accent);
    }

    /* ‚îÄ‚îÄ‚îÄ Main Layout ‚îÄ‚îÄ‚îÄ */
    .main {
      display: grid;
      grid-template-columns: 380px 1fr;
      height: calc(100vh - 65px);
    }

    /* ‚îÄ‚îÄ‚îÄ Sidebar ‚îÄ‚îÄ‚îÄ */
    .sidebar {
      background: var(--surface);
      border-right: 1px solid var(--border);
      overflow-y: auto;
      padding: 1.5rem;
      scrollbar-width: thin;
      scrollbar-color: var(--border) transparent;
    }

    .sidebar::-webkit-scrollbar {
      width: 4px;
    }

    .sidebar::-webkit-scrollbar-thumb {
      background: var(--border);
      border-radius: 4px;
    }

    .form-section {
      margin-bottom: 2rem;
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 1rem;
      cursor: pointer;
    }

    .section-icon {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      flex-shrink: 0;
    }

    .section-title {
      font-family: 'Syne', sans-serif;
      font-weight: 600;
      font-size: 0.875rem;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      color: var(--text2);
    }

    .section-toggle {
      margin-left: auto;
      color: var(--text3);
      font-size: 0.75rem;
      transition: transform 0.2s;
    }

    .section-toggle.open {
      transform: rotate(180deg);
    }

    .form-body {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.75rem;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
    }

    label {
      font-size: 0.75rem;
      color: var(--text2);
      font-weight: 500;
      letter-spacing: 0.03em;
    }

    input,
    textarea,
    select {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text);
      font-family: 'DM Sans', sans-serif;
      font-size: 0.875rem;
      padding: 0.6rem 0.875rem;
      transition: all 0.2s;
      width: 100%;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--accent);
      background: rgba(183, 148, 246, 0.08);
      box-shadow: 0 0 0 3px rgba(183, 148, 246, 0.1);
    }

    textarea {
      resize: vertical;
      min-height: 80px;
    }

    select option {
      background: var(--surface);
    }

    /* Tags input */
    .tags-container {
      display: flex;
      flex-wrap: wrap;
      gap: 0.35rem;
      padding: 0.5rem;
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 8px;
      min-height: 42px;
      cursor: text;
    }

    .tag {
      display: flex;
      align-items: center;
      gap: 0.35rem;
      background: rgba(183, 148, 246, 0.12);
      border: 1px solid rgba(183, 148, 246, 0.25);
      color: var(--accent);
      border-radius: 6px;
      padding: 0.2rem 0.5rem;
      font-size: 0.75rem;
      font-family: 'JetBrains Mono', monospace;
      animation: tagIn 0.15s ease;
    }

    @keyframes tagIn {
      from {
        opacity: 0;
        transform: scale(0.85);
      }

      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .tag-remove {
      cursor: pointer;
      opacity: 0.6;
      font-size: 0.7rem;
      transition: opacity 0.15s;
    }

    .tag-remove:hover {
      opacity: 1;
      color: var(--danger);
    }

    .tag-input {
      border: none !important;
      background: transparent !important;
      padding: 0.1rem 0.25rem !important;
      font-size: 0.75rem !important;
      min-width: 80px !important;
      flex: 1;
    }

    /* Dynamic list items */
    .list-item {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 1rem;
      position: relative;
      transition: border-color 0.2s;
    }

    .list-item:hover {
      border-color: var(--accent);
    }

    .item-remove {
      position: absolute;
      top: 0.6rem;
      right: 0.6rem;
      background: rgba(248, 113, 113, 0.1);
      border: none;
      color: var(--danger);
      cursor: pointer;
      border-radius: 6px;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.875rem;
      opacity: 0;
      transition: opacity 0.2s;
    }

    .list-item:hover .item-remove {
      opacity: 1;
    }

    .add-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.6rem 1rem;
      background: transparent;
      border: 1px dashed var(--border);
      border-radius: 8px;
      color: var(--text3);
      font-size: 0.8125rem;
      cursor: pointer;
      transition: all 0.2s;
      width: 100%;
      justify-content: center;
    }

    .add-btn:hover {
      border-color: var(--accent);
      color: var(--accent);
      background: rgba(183, 148, 246, 0.09);
    }

    /* ‚îÄ‚îÄ‚îÄ Generate Button ‚îÄ‚îÄ‚îÄ */
    .generate-section {
      padding: 1rem 0;
      border-top: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .generate-btn {
      width: 100%;
      padding: 0.875rem;
      background: linear-gradient(135deg, var(--accent), var(--exotic2));
      border: none;
      border-radius: 10px;
      color: white;
      font-family: 'Syne', sans-serif;
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
      overflow: hidden;
      letter-spacing: 0.02em;
    }

    .generate-btn::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transform: translateX(-100%);
      transition: transform 0.5s;
    }

    .generate-btn:hover::before {
      transform: translateX(100%);
    }

    .generate-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 24px rgba(183, 148, 246, 0.35);
    }

    .generate-btn:active {
      transform: translateY(0);
    }

    .generate-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .generate-options {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 0.5rem;
    }

    .gen-option {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.25rem;
      padding: 0.6rem;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: var(--surface2);
      cursor: pointer;
      transition: all 0.2s;
      font-size: 0.7rem;
      color: var(--text2);
    }

    .gen-option.selected {
      border-color: var(--accent);
      background: rgba(183, 148, 246, 0.1);
      color: var(--accent);
    }

    .gen-option .icon {
      font-size: 1.25rem;
    }

    /* ‚îÄ‚îÄ‚îÄ Output Panel ‚îÄ‚îÄ‚îÄ */
    .output-panel {
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .output-tabs {
      display: flex;
      border-bottom: 1px solid var(--border);
      background: var(--surface);
      padding: 0 1.5rem;
      gap: 0.25rem;
    }

    .output-tab {
      padding: 1rem 1.25rem;
      border: none;
      background: transparent;
      color: var(--text3);
      font-family: 'DM Sans', sans-serif;
      font-size: 0.875rem;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: all 0.2s;
      position: relative;
      top: 1px;
    }

    .output-tab:hover {
      color: var(--text2);
    }

    .output-tab.active {
      color: var(--accent);
      border-bottom-color: var(--accent);
    }

    .output-content {
      flex: 1;
      overflow-y: auto;
      padding: 2rem;
      scrollbar-width: thin;
      scrollbar-color: var(--border) transparent;
    }

    /* ‚îÄ‚îÄ‚îÄ Empty State ‚îÄ‚îÄ‚îÄ */
    .empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      gap: 1rem;
      color: var(--text3);
    }

    .empty-icon {
      font-size: 4rem;
      opacity: 0.4;
    }

    .empty-title {
      font-family: 'Syne', sans-serif;
      font-size: 1.25rem;
      color: var(--text2);
    }

    .empty-sub {
      font-size: 0.875rem;
      max-width: 320px;
      text-align: center;
      line-height: 1.6;
    }

    /* ‚îÄ‚îÄ‚îÄ Loading ‚îÄ‚îÄ‚îÄ */
    .loading-overlay {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      gap: 1.5rem;
    }

    .spinner {
      width: 56px;
      height: 56px;
      border: 3px solid var(--surface3);
      border-top-color: var(--accent);
      border-right-color: var(--exotic2);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .loading-steps {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      width: 280px;
    }

    .loading-step {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.6rem 0.875rem;
      border-radius: 8px;
      background: var(--surface2);
      font-size: 0.8125rem;
      color: var(--text3);
      animation: stepIn 0.3s ease both;
    }

    .loading-step.done {
      color: var(--success);
    }

    .loading-step.active {
      color: var(--accent);
      background: rgba(183, 148, 246, 0.12);
    }

    @keyframes stepIn {
      from {
        opacity: 0;
        transform: translateX(-10px);
      }

      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    /* ‚îÄ‚îÄ‚îÄ Resume Output ‚îÄ‚îÄ‚îÄ */
    .resume-doc {
      max-width: 800px;
      margin: 0 auto;
      background: #ffffff;
      border-radius: 12px;
      overflow: hidden;
      border: 1px solid var(--border);
      color: #0f172a;
    }

    .resume-header-section {
      background: linear-gradient(135deg, #f3ebf9, #f0edff);
      padding: 2.5rem;
      border-bottom: 1px solid var(--border);
    }

    .resume-name {
      font-family: 'Syne', sans-serif;
      font-size: 2.25rem;
      font-weight: 800;
      letter-spacing: -0.02em;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 0.25rem;
    }

    .resume-target {
      color: var(--accent);
      font-size: 1rem;
      font-weight: 500;
      margin-bottom: 1rem;
    }

    .resume-contact {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
    }

    .contact-item {
      display: flex;
      align-items: center;
      gap: 0.35rem;
      font-size: 0.8rem;
      color: var(--text2);
      font-family: 'JetBrains Mono', monospace;
    }

    .resume-body {
      padding: 2rem;
    }

    .resume-section {
      margin-bottom: 1.75rem;
    }

    .rs-title {
      font-family: 'Syne', sans-serif;
      font-weight: 700;
      font-size: 0.75rem;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--accent);
      border-bottom: 1px solid rgba(183, 148, 246, 0.24);
      padding-bottom: 0.5rem;
      margin-bottom: 1rem;
    }

    .rs-summary {
      font-size: 0.875rem;
      line-height: 1.7;
      color: var(--text);
    }

    .skills-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
    }

    .skill-tag {
      padding: 0.25rem 0.625rem;
      border-radius: 6px;
      font-size: 0.75rem;
      font-family: 'JetBrains Mono', monospace;
      border: 1px solid;
    }

    .skill-tag.languages {
      background: rgba(183, 148, 246, 0.12);
      border-color: rgba(183, 148, 246, 0.3);
      color: var(--accent);
    }

    .skill-tag.frameworks {
      background: rgba(147, 197, 253, 0.12);
      border-color: rgba(147, 197, 253, 0.3);
      color: var(--accent2);
    }

    .skill-tag.databases {
      background: rgba(125, 211, 252, 0.12);
      border-color: rgba(125, 211, 252, 0.3);
      color: var(--exotic2);
    }

    .skill-tag.cloud {
      background: rgba(196, 181, 253, 0.12);
      border-color: rgba(196, 181, 253, 0.3);
      color: var(--accent3);
    }

    .skill-tag.tools {
      background: rgba(167, 139, 250, 0.12);
      border-color: rgba(167, 139, 250, 0.3);
      color: var(--accent2);
    }

    .skill-tag.other {
      background: var(--surface3);
      border-color: var(--border);
      color: var(--text2);
    }

    .exp-item,
    .proj-item,
    .edu-item {
      margin-bottom: 1.25rem;
    }

    .exp-title-row {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 0.2rem;
    }

    .exp-role {
      font-weight: 600;
      font-size: 0.9375rem;
    }

    .exp-company {
      font-size: 0.875rem;
      color: var(--accent);
    }

    .exp-dates {
      font-size: 0.75rem;
      color: var(--text3);
      font-family: 'JetBrains Mono', monospace;
      white-space: nowrap;
    }

    .exp-bullets {
      margin-top: 0.5rem;
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 0.3rem;
    }

    .exp-bullets li {
      font-size: 0.8125rem;
      color: var(--text);
      line-height: 1.5;
      padding-left: 1rem;
      position: relative;
    }

    .exp-bullets li::before {
      content: '‚ñ∏';
      position: absolute;
      left: 0;
      color: var(--accent);
    }

    .exp-techs {
      display: flex;
      flex-wrap: wrap;
      gap: 0.3rem;
      margin-top: 0.5rem;
    }

    .tech-pill {
      font-size: 0.7rem;
      font-family: 'JetBrains Mono', monospace;
      background: var(--surface3);
      border-radius: 4px;
      padding: 0.1rem 0.4rem;
      color: var(--text2);
    }

    .proj-name {
      font-weight: 600;
      font-size: 0.9rem;
    }

    .proj-desc {
      font-size: 0.8125rem;
      color: var(--text);
      margin: 0.25rem 0;
      line-height: 1.5;
    }

    .proj-links {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.35rem;
    }

    .proj-link {
      font-size: 0.7rem;
      color: var(--accent);
      text-decoration: none;
      font-family: 'JetBrains Mono', monospace;
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }

    .edu-degree {
      font-weight: 600;
      font-size: 0.9rem;
    }

    .edu-institution {
      font-size: 0.8125rem;
      color: var(--text);
    }

    .edu-meta {
      font-size: 0.75rem;
      color: var(--text3);
      font-family: 'JetBrains Mono', monospace;
    }

    /* ‚îÄ‚îÄ‚îÄ Cover Letter ‚îÄ‚îÄ‚îÄ */
    .cover-letter-doc {
      max-width: 740px;
      margin: 0 auto;
      background: #ffffff;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 3rem;
      color: var(--text);
    }

    .cl-subject {
      font-size: 0.75rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--accent);
      margin-bottom: 0.25rem;
      font-family: 'Syne', sans-serif;
    }

    .cl-title {
      font-family: 'Syne', sans-serif;
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 1.5rem;
      color: var(--text);
    }

    .cl-para {
      font-size: 0.9rem;
      line-height: 1.75;
      color: var(--text);
      margin-bottom: 1.25rem;
    }

    .cl-sig {
      margin-top: 2rem;
      font-family: 'Syne', sans-serif;
      font-weight: 700;
      font-size: 1.1rem;
      background: linear-gradient(135deg, var(--accent), var(--exotic2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* ‚îÄ‚îÄ‚îÄ Portfolio ‚îÄ‚îÄ‚îÄ */
    .portfolio-preview {
      max-width: 900px;
      margin: 0 auto;
    }

    .portfolio-hero {
      text-align: center;
      padding: 3rem 2rem;
      background: linear-gradient(135deg, rgba(183, 148, 246, 0.1), rgba(147, 197, 253, 0.08));
      border-radius: 16px;
      border: 1px solid rgba(183, 148, 246, 0.24);
      margin-bottom: 2rem;
    }

    .portfolio-name {
      font-family: 'Syne', sans-serif;
      font-size: 3rem;
      font-weight: 800;
      letter-spacing: -0.03em;
      margin-bottom: 0.5rem;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .portfolio-tagline {
      font-size: 1.1rem;
      color: var(--accent);
      margin-bottom: 1.5rem;
    }

    .portfolio-stats {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .stat-card {
      background: var(--surface2);
      border-radius: 12px;
      padding: 1.25rem;
      text-align: center;
      border: 1px solid var(--border);
    }

    .stat-num {
      font-family: 'Syne', sans-serif;
      font-size: 2rem;
      font-weight: 800;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .stat-label {
      font-size: 0.75rem;
      color: var(--text3);
      margin-top: 0.25rem;
    }

    .projects-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .portfolio-proj-card {
      background: var(--surface2);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.5rem;
      transition: all 0.2s;
      position: relative;
      overflow: hidden;
    }

    .portfolio-proj-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--card-color, var(--accent));
    }

    .portfolio-proj-card:hover {
      border-color: var(--accent);
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(183, 148, 246, 0.15);
    }

    .proj-card-name {
      font-family: 'Syne', sans-serif;
      font-weight: 700;
      font-size: 1rem;
      margin-bottom: 0.5rem;
      color: var(--text);
    }

    .proj-card-cat {
      font-size: 0.7rem;
      color: var(--text3);
      letter-spacing: 0.08em;
      text-transform: uppercase;
      margin-bottom: 0.75rem;
    }

    .proj-card-desc {
      font-size: 0.8125rem;
      color: var(--text);
      line-height: 1.6;
      margin-bottom: 0.75rem;
    }

    .proj-card-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.3rem;
    }

    .proj-tag {
      font-size: 0.7rem;
      font-family: 'JetBrains Mono', monospace;
      padding: 0.15rem 0.4rem;
      border-radius: 4px;
      background: rgba(183, 148, 246, 0.1);
      color: var(--accent);
      border: 1px solid rgba(183, 148, 246, 0.25);
    }

    .skills-section {
      background: var(--surface2);
      border-radius: 12px;
      padding: 1.5rem;
      border: 1px solid var(--border);
    }

    .skills-bars {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .skill-bar-item {
      display: flex;
      flex-direction: column;
      gap: 0.35rem;
    }

    .skill-bar-header {
      display: flex;
      justify-content: space-between;
      font-size: 0.8125rem;
    }

    .skill-bar-track {
      height: 6px;
      background: var(--surface3);
      border-radius: 99px;
      overflow: hidden;
    }

    .skill-bar-fill {
      height: 100%;
      border-radius: 99px;
      background: linear-gradient(90deg, var(--accent), var(--exotic2));
      transition: width 1s ease;
    }

    /* ‚îÄ‚îÄ‚îÄ ATS Score ‚îÄ‚îÄ‚îÄ */
    .ats-panel {
      max-width: 700px;
      margin: 0 auto;
    }

    .ats-score-ring {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 2rem;
    }

    .score-circle {
      width: 140px;
      height: 140px;
      border-radius: 50%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: var(--surface2);
      border: 4px solid var(--accent);
      margin-bottom: 0.75rem;
    }

    .score-num {
      font-family: 'Syne', sans-serif;
      font-size: 2.5rem;
      font-weight: 800;
      background: linear-gradient(135deg, var(--accent), var(--exotic2));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .score-label {
      font-size: 0.7rem;
      color: var(--text3);
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    .ats-breakdown {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.75rem;
      margin-bottom: 1.5rem;
    }

    .breakdown-card {
      background: var(--surface2);
      border-radius: 10px;
      padding: 1rem;
      border: 1px solid var(--border);
    }

    .bd-label {
      font-size: 0.75rem;
      color: var(--text3);
      margin-bottom: 0.25rem;
    }

    .bd-value {
      font-family: 'Syne', sans-serif;
      font-size: 1.5rem;
      font-weight: 700;
    }

    .keyword-pills {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      margin-bottom: 1rem;
    }

    .kw-matched {
      background: rgba(52, 211, 153, 0.1);
      border: 1px solid rgba(52, 211, 153, 0.3);
      color: var(--success);
      border-radius: 6px;
      padding: 0.2rem 0.5rem;
      font-size: 0.75rem;
      font-family: 'JetBrains Mono', monospace;
    }

    .kw-missing {
      background: rgba(248, 113, 113, 0.1);
      border: 1px solid rgba(248, 113, 113, 0.3);
      color: var(--danger);
      border-radius: 6px;
      padding: 0.2rem 0.5rem;
      font-size: 0.75rem;
      font-family: 'JetBrains Mono', monospace;
    }

    .recs-list {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .rec-item {
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
      padding: 0.75rem 1rem;
      background: rgba(251, 191, 36, 0.05);
      border: 1px solid rgba(251, 191, 36, 0.15);
      border-radius: 8px;
      font-size: 0.8125rem;
      color: var(--text2);
    }

    .rec-icon {
      color: var(--warning);
      flex-shrink: 0;
    }

    /* ‚îÄ‚îÄ‚îÄ Export button ‚îÄ‚îÄ‚îÄ */
    .export-bar {
      display: flex;
      gap: 0.75rem;
      justify-content: flex-end;
      padding: 1rem 0;
    }

    .export-btn {
      padding: 0.5rem 1.25rem;
      border-radius: 8px;
      border: 1px solid var(--border);
      background: var(--surface2);
      color: var(--text2);
      font-size: 0.8125rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.2s;
      font-family: 'DM Sans', sans-serif;
    }

    .export-btn:hover {
      border-color: var(--accent);
      color: var(--text);
    }

    .export-btn.primary {
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      border-color: transparent;
      color: white;
      font-weight: 500;
    }

    /* ‚îÄ‚îÄ‚îÄ Responsiveness ‚îÄ‚îÄ‚îÄ */
    @media (max-width: 900px) {
      .main {
        grid-template-columns: 1fr;
      }

      .sidebar {
        height: auto;
        max-height: 50vh;
      }

      .brand-sub {
        display: none;
      }
    }

    /* ‚îÄ‚îÄ‚îÄ Pill label ‚îÄ‚îÄ‚îÄ */
    .pill-label {
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      padding: 0.2rem 0.625rem;
      border-radius: 99px;
      font-size: 0.7rem;
      font-weight: 600;
    }

    .pill-success {
      background: rgba(52, 211, 153, 0.15);
      color: var(--success);
    }

    .pill-warning {
      background: rgba(251, 191, 36, 0.15);
      color: var(--warning);
    }

    .divider {
      height: 1px;
      background: var(--border);
      margin: 1rem 0;
    }

    h3 {
      font-family: 'Syne', sans-serif;
      font-size: 0.9375rem;
      font-weight: 600;
      margin-bottom: 0.75rem;
      color: var(--text);
    }
  </style>
</head>

<body>
  <div class="app">

    <!-- Header -->
    <header>
      <div class="brand-stack">
        <div class="logo">BuildMy<span>Folio</span></div>
        <div class="brand-sub">AI Career Studio</div>
      </div>
      <nav id="navTabs">
        <button class="nav-btn active" data-panel="builder">‚ú¶ Builder</button>
        <button class="nav-btn" data-panel="ats">‚óà ATS Check</button>
        <button class="nav-btn" data-panel="about">‚óé About</button>
      </nav>
    </header>

    <!-- Builder Panel -->
    <div id="panel-builder" class="main">

      <!-- Sidebar Form -->
      <aside class="sidebar" id="profileForm">

        <!-- Personal Info -->
        <div class="form-section">
          <div class="section-header" onclick="toggleSection('personal')">
            <div class="section-icon" style="background:rgba(183,148,246,0.16)">üë§</div>
            <span class="section-title">Personal Info</span>
            <span class="section-toggle open" id="toggle-personal">‚ñæ</span>
          </div>
          <div class="form-body" id="section-personal">
            <div class="form-row">
              <div class="field">
                <label>Full Name *</label>
                <input type="text" id="name" placeholder="Priya Sharma" />
              </div>
              <div class="field">
                <label>Email *</label>
                <input type="email" id="email" placeholder="priya@example.com" />
              </div>
            </div>
            <div class="form-row">
              <div class="field">
                <label>Phone</label>
                <input type="tel" id="phone" placeholder="+91 9876543210" />
              </div>
              <div class="field">
                <label>Location</label>
                <input type="text" id="location" placeholder="Hyderabad, India" />
              </div>
            </div>
            <div class="form-row">
              <div class="field">
                <label>LinkedIn URL</label>
                <input type="url" id="linkedin" placeholder="linkedin.com/in/priya" />
              </div>
              <div class="field">
                <label>GitHub URL</label>
                <input type="url" id="github" placeholder="github.com/priya" />
              </div>
            </div>
            <div class="form-row">
              <div class="field">
                <label>Target Role *</label>
                <input type="text" id="targetRole" placeholder="Full Stack Developer" />
              </div>
              <div class="field">
                <label>Target Industry *</label>
                <select id="targetIndustry">
                  <option value="technology">Technology</option>
                  <option value="data science">Data Science</option>
                  <option value="fintech">FinTech</option>
                  <option value="healthcare">Healthcare Tech</option>
                  <option value="product">Product</option>
                  <option value="design">Design</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- Education -->
        <div class="form-section">
          <div class="section-header" onclick="toggleSection('education')">
            <div class="section-icon" style="background:rgba(147,197,253,0.15)">üéì</div>
            <span class="section-title">Education</span>
            <span class="section-toggle open" id="toggle-education">‚ñæ</span>
          </div>
          <div class="form-body" id="section-education">
            <div id="educationList"></div>
            <button class="add-btn" onclick="addEducation()">+ Add Education</button>
          </div>
        </div>

        <!-- Experience -->
        <div class="form-section">
          <div class="section-header" onclick="toggleSection('experience')">
            <div class="section-icon" style="background:rgba(125,211,252,0.15)">üíº</div>
            <span class="section-title">Experience</span>
            <span class="section-toggle open" id="toggle-experience">‚ñæ</span>
          </div>
          <div class="form-body" id="section-experience">
            <div id="experienceList"></div>
            <button class="add-btn" onclick="addExperience()">+ Add Experience</button>
          </div>
        </div>

        <!-- Projects -->
        <div class="form-section">
          <div class="section-header" onclick="toggleSection('projects')">
            <div class="section-icon" style="background:rgba(183,148,246,0.15)">üöÄ</div>
            <span class="section-title">Projects</span>
            <span class="section-toggle open" id="toggle-projects">‚ñæ</span>
          </div>
          <div class="form-body" id="section-projects">
            <div id="projectsList"></div>
            <button class="add-btn" onclick="addProject()">+ Add Project</button>
          </div>
        </div>

        <!-- Skills -->
        <div class="form-section">
          <div class="section-header" onclick="toggleSection('skills')">
            <div class="section-icon" style="background:rgba(147,197,253,0.15)">‚ö°</div>
            <span class="section-title">Skills</span>
            <span class="section-toggle open" id="toggle-skills">‚ñæ</span>
          </div>
          <div class="form-body" id="section-skills">
            <div class="field">
              <label>Technical Skills (press Enter or comma)</label>
              <div class="tags-container" id="skillsContainer">
                <input type="text" class="tag-input" id="skillInput" placeholder="Type skill & press Enter..." />
              </div>
            </div>
            <div class="field">
              <label>Certifications</label>
              <div class="tags-container" id="certContainer">
                <input type="text" class="tag-input" id="certInput" placeholder="AWS Certified, Google Analytics..." />
              </div>
            </div>
          </div>
        </div>

        <!-- Generate Options -->
        <div class="generate-section">
          <div class="field">
            <label>Job Description (optional ‚Äî improves tailoring)</label>
            <textarea id="jobDescription"
              placeholder="Paste the job description here for AI-powered keyword matching..."></textarea>
          </div>
          <div class="field">
            <label>Company Name (for cover letter)</label>
            <input type="text" id="companyName" placeholder="Google, Infosys, Swiggy..." />
          </div>
          <div class="field">
            <label>Tone</label>
            <select id="tone">
              <option value="professional">Professional</option>
              <option value="technical">Technical</option>
              <option value="creative">Creative</option>
            </select>
          </div>
          <div class="generate-options">
            <div class="gen-option selected" id="opt-resume" onclick="toggleOption('resume')">
              <span class="icon">üìÑ</span>
              <span>Resume</span>
            </div>
            <div class="gen-option selected" id="opt-cover" onclick="toggleOption('cover')">
              <span class="icon">‚úâÔ∏è</span>
              <span>Cover Letter</span>
            </div>
            <div class="gen-option selected" id="opt-portfolio" onclick="toggleOption('portfolio')">
              <span class="icon">üåê</span>
              <span>Portfolio</span>
            </div>
          </div>
          <button class="generate-btn" id="generateBtn" onclick="generateDocuments()">
            ‚ú¶ Generate with AI
          </button>
        </div>

      </aside>

      <!-- Output Panel -->
      <div class="output-panel">
        <div class="output-tabs">
          <button class="output-tab active" data-tab="resume">Resume</button>
          <button class="output-tab" data-tab="cover">Cover Letter</button>
          <button class="output-tab" data-tab="portfolio">Portfolio</button>
          <button class="output-tab" data-tab="analysis">Skills Analysis</button>
        </div>
        <div class="output-content" id="outputContent">
          <div class="empty-state">
            <div class="empty-icon">‚ú¶</div>
            <div class="empty-title">Your AI-crafted career assets await</div>
            <div class="empty-sub">Fill in your profile details on the left, then click "Generate with AI" to create
              tailored resume, cover letter, and portfolio.</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ATS Check Panel -->
    <div id="panel-ats" class="main" style="display:none; padding: 2rem;">
      <div style="max-width:700px; margin: 0 auto; width:100%;">
        <h2 style="font-family:'Syne',sans-serif; font-size:1.5rem; margin-bottom:0.5rem;">ATS Compatibility Checker
        </h2>
        <p style="color:var(--text2); font-size:0.875rem; margin-bottom:1.5rem;">Paste your resume and job description
          to get an ATS score with actionable improvements.</p>
        <div class="field" style="margin-bottom:1rem;">
          <label>Your Resume Text</label>
          <textarea id="atsResume" style="min-height:160px;" placeholder="Paste your resume text here..."></textarea>
        </div>
        <div class="field" style="margin-bottom:1rem;">
          <label>Job Description</label>
          <textarea id="atsJD" style="min-height:120px;" placeholder="Paste the job description here..."></textarea>
        </div>
        <button class="generate-btn" style="max-width:300px;" onclick="runATSCheck()">‚óà Analyze ATS Score</button>
        <div id="atsResult" style="margin-top:1.5rem;"></div>
      </div>
    </div>

    <!-- About Panel -->
    <div id="panel-about" style="display:none; padding:3rem; max-width:800px; margin:0 auto;">
      <h2 style="font-family:'Syne',sans-serif; font-size:2rem; margin-bottom:1rem;">About BuildMyFolio</h2>
      <p style="color:var(--text2); line-height:1.8; margin-bottom:1.5rem;">
        BuildMyFolio is an AI-powered platform that helps students and freshers craft tailored resumes, clear cover
        letters, and portfolio pages with ATS-friendly formatting in seconds.
      </p>
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:1rem; margin-bottom:2rem;">
        <div class="breakdown-card">
          <div style="font-size:1.5rem; margin-bottom:0.5rem;">ü§ñ</div>
          <div style="font-family:'Syne',sans-serif; font-weight:600; margin-bottom:0.25rem;">AI-Powered Generation
          </div>
          <div style="font-size:0.8rem; color:var(--text2);">NLP-based resume tailoring using keyword extraction, TF-IDF
            similarity, and rule-based generation</div>
        </div>
        <div class="breakdown-card">
          <div style="font-size:1.5rem; margin-bottom:0.5rem;">üìä</div>
          <div style="font-family:'Syne',sans-serif; font-weight:600; margin-bottom:0.25rem;">ATS Score Prediction</div>
          <div style="font-size:0.8rem; color:var(--text2);">Analyzes keyword match, format compliance, action verbs,
            and quantification score</div>
        </div>
        <div class="breakdown-card">
          <div style="font-size:1.5rem; margin-bottom:0.5rem;">üéØ</div>
          <div style="font-family:'Syne',sans-serif; font-weight:600; margin-bottom:0.25rem;">Skill Gap Analysis</div>
          <div style="font-size:0.8rem; color:var(--text2);">Compares your skills vs job requirements with personalized
            learning recommendations</div>
        </div>
        <div class="breakdown-card">
          <div style="font-size:1.5rem; margin-bottom:0.5rem;">üåê</div>
          <div style="font-family:'Syne',sans-serif; font-weight:600; margin-bottom:0.25rem;">Portfolio Generator</div>
          <div style="font-size:0.8rem; color:var(--text2);">Auto-generates a structured portfolio with project cards,
            skill charts, and bio sections</div>
        </div>
      </div>
      <div style="background:var(--surface2); border-radius:12px; padding:1.5rem; border:1px solid var(--border);">
        <div style="font-family:'Syne',sans-serif; font-weight:600; margin-bottom:0.75rem;">Tech Stack</div>
        <div style="display:flex; flex-wrap:wrap; gap:0.5rem;">
          <span class="skill-tag languages">FastAPI</span>
          <span class="skill-tag frameworks">React</span>
          <span class="skill-tag languages">Python</span>
          <span class="skill-tag frameworks">TF-IDF ML</span>
          <span class="skill-tag databases">PostgreSQL</span>
          <span class="skill-tag cloud">Docker</span>
          <span class="skill-tag tools">REST API</span>
          <span class="skill-tag tools">Pydantic</span>
        </div>
      </div>
    </div>

  </div>

  <script>
    // ‚îÄ‚îÄ‚îÄ State ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    const state = {
      skills: [],
      certifications: [],
      education: [],
      experience: [],
      projects: [],
      generatedData: null,
      latestPortfolio: null,
      activeTab: 'resume',
      options: { resume: true, cover: true, portfolio: true },
    };

    const API_BASE = 'http://localhost:8000';

    // ‚îÄ‚îÄ‚îÄ Nav ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    document.querySelectorAll('[data-panel]').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('[data-panel]').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const panel = btn.dataset.panel;
        document.getElementById('panel-builder').style.display = panel === 'builder' ? 'grid' : 'none';
        document.getElementById('panel-ats').style.display = panel === 'ats' ? 'flex' : 'none';
        document.getElementById('panel-about').style.display = panel === 'about' ? 'block' : 'none';
      });
    });

    // ‚îÄ‚îÄ‚îÄ Output Tabs ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    document.querySelectorAll('[data-tab]').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('[data-tab]').forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        state.activeTab = tab.dataset.tab;
        if (state.generatedData) renderOutput(state.generatedData);
      });
    });

    // ‚îÄ‚îÄ‚îÄ Section Toggle ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function toggleSection(id) {
      const el = document.getElementById('section-' + id);
      const toggle = document.getElementById('toggle-' + id);
      const hidden = el.style.display === 'none';
      el.style.display = hidden ? 'flex' : 'none';
      toggle.classList.toggle('open', hidden);
    }

    // ‚îÄ‚îÄ‚îÄ Generate Options ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function toggleOption(opt) {
      state.options[opt] = !state.options[opt];
      document.getElementById('opt-' + opt).classList.toggle('selected', state.options[opt]);
    }

    // ‚îÄ‚îÄ‚îÄ Tags Input ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function initTagInput(inputId, containerId, stateKey) {
      const input = document.getElementById(inputId);
      input.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ',') {
          e.preventDefault();
          const val = input.value.trim().replace(/,$/, '');
          if (val && !state[stateKey].includes(val)) {
            state[stateKey].push(val);
            renderTag(containerId, stateKey, val);
          }
          input.value = '';
        } else if (e.key === 'Backspace' && !input.value && state[stateKey].length) {
          const last = state[stateKey].pop();
          document.getElementById(containerId).querySelector(`.tag[data-val="${CSS.escape(last)}"]`)?.remove();
        }
      });
      document.getElementById(containerId).addEventListener('click', e => input.focus());
    }

    function renderTag(containerId, stateKey, val) {
      const container = document.getElementById(containerId);
      const input = container.querySelector('.tag-input');
      const tag = document.createElement('span');
      tag.className = 'tag';
      tag.dataset.val = val;
      tag.innerHTML = `${val} <span class="tag-remove" onclick="removeTag('${containerId}','${stateKey}','${val}',this.parentElement)">‚úï</span>`;
      container.insertBefore(tag, input);
    }

    function removeTag(containerId, stateKey, val, el) {
      state[stateKey] = state[stateKey].filter(s => s !== val);
      el.remove();
    }

    initTagInput('skillInput', 'skillsContainer', 'skills');
    initTagInput('certInput', 'certContainer', 'certifications');

    // ‚îÄ‚îÄ‚îÄ Education ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function addEducation() {
      const id = Date.now();
      state.education.push({ id });
      renderEducationItem(id);
    }

    function renderEducationItem(id) {
      const el = document.createElement('div');
      el.className = 'list-item';
      el.id = 'edu-' + id;
      el.innerHTML = `
    <button class="item-remove" onclick="removeItem('education','${id}','edu-${id}')">‚úï</button>
    <div style="display:flex;flex-direction:column;gap:0.6rem;">
      <div class="form-row">
        <div class="field"><label>Institution</label><input type="text" onchange="updateItem('education','${id}','institution',this.value)" placeholder="IIT Hyderabad" /></div>
        <div class="field"><label>Degree</label><input type="text" onchange="updateItem('education','${id}','degree',this.value)" placeholder="B.Tech" /></div>
      </div>
      <div class="form-row">
        <div class="field"><label>Field of Study</label><input type="text" onchange="updateItem('education','${id}','field',this.value)" placeholder="Computer Science" /></div>
        <div class="field"><label>GPA</label><input type="number" step="0.1" min="0" max="10" onchange="updateItem('education','${id}','gpa',parseFloat(this.value))" placeholder="8.5" /></div>
      </div>
      <div class="form-row">
        <div class="field"><label>Start Year</label><input type="number" onchange="updateItem('education','${id}','start_year',parseInt(this.value))" placeholder="2021" /></div>
        <div class="field"><label>End Year</label><input type="number" onchange="updateItem('education','${id}','end_year',parseInt(this.value))" placeholder="2025" /></div>
      </div>
    </div>
  `;
      document.getElementById('educationList').appendChild(el);
    }

    // ‚îÄ‚îÄ‚îÄ Experience ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function addExperience() {
      const id = Date.now();
      state.experience.push({ id });
      renderExperienceItem(id);
    }

    function renderExperienceItem(id) {
      const el = document.createElement('div');
      el.className = 'list-item';
      el.id = 'exp-' + id;
      el.innerHTML = `
    <button class="item-remove" onclick="removeItem('experience','${id}','exp-${id}')">‚úï</button>
    <div style="display:flex;flex-direction:column;gap:0.6rem;">
      <div class="form-row">
        <div class="field"><label>Company</label><input type="text" onchange="updateItem('experience','${id}','company',this.value)" placeholder="Google" /></div>
        <div class="field"><label>Role</label><input type="text" onchange="updateItem('experience','${id}','role',this.value)" placeholder="Software Intern" /></div>
      </div>
      <div class="form-row">
        <div class="field"><label>Start Date</label><input type="text" onchange="updateItem('experience','${id}','start_date',this.value)" placeholder="May 2024" /></div>
        <div class="field"><label>End Date</label><input type="text" onchange="updateItem('experience','${id}','end_date',this.value)" placeholder="Aug 2024" /></div>
      </div>
      <div class="field"><label>Description</label><textarea onchange="updateItem('experience','${id}','description',this.value)" placeholder="Describe what you did, your impact, and achievements..."></textarea></div>
      <div class="field"><label>Technologies Used</label><input type="text" onchange="updateItem('experience','${id}','technologies',this.value.split(',').map(t=>t.trim()))" placeholder="Python, React, PostgreSQL" /></div>
    </div>
  `;
      document.getElementById('experienceList').appendChild(el);
    }

    // ‚îÄ‚îÄ‚îÄ Projects ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function addProject() {
      const id = Date.now();
      state.projects.push({ id });
      renderProjectItem(id);
    }

    function renderProjectItem(id) {
      const el = document.createElement('div');
      el.className = 'list-item';
      el.id = 'proj-' + id;
      el.innerHTML = `
    <button class="item-remove" onclick="removeItem('projects','${id}','proj-${id}')">‚úï</button>
    <div style="display:flex;flex-direction:column;gap:0.6rem;">
      <div class="form-row">
        <div class="field"><label>Project Name</label><input type="text" onchange="updateItem('projects','${id}','name',this.value)" placeholder="BuildMyFolio Assistant" /></div>
        <div class="field"><label>GitHub URL</label><input type="url" onchange="updateItem('projects','${id}','github_url',this.value)" placeholder="github.com/..." /></div>
      </div>
      <div class="field"><label>Description</label><textarea onchange="updateItem('projects','${id}','description',this.value)" placeholder="What does this project do? What problem does it solve?"></textarea></div>
      <div class="form-row">
        <div class="field"><label>Technologies</label><input type="text" onchange="updateItem('projects','${id}','technologies',this.value.split(',').map(t=>t.trim()))" placeholder="React, Python, ML" /></div>
        <div class="field"><label>Live URL</label><input type="url" onchange="updateItem('projects','${id}','live_url',this.value)" placeholder="https://..." /></div>
      </div>
      <div class="field"><label>Impact / Result</label><input type="text" onchange="updateItem('projects','${id}','impact',this.value)" placeholder="Reduced time by 60%, helped 100+ users..." /></div>
    </div>
  `;
      document.getElementById('projectsList').appendChild(el);
    }

    function updateItem(arr, id, key, val) {
      const item = state[arr].find(i => String(i.id) === String(id));
      if (item) item[key] = val;
    }

    function removeItem(arr, id, elId) {
      state[arr] = state[arr].filter(i => String(i.id) !== String(id));
      document.getElementById(elId)?.remove();
    }

    // ‚îÄ‚îÄ‚îÄ Build Profile ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function buildProfile() {
      return {
        name: document.getElementById('name').value || 'Student',
        email: document.getElementById('email').value || 'email@example.com',
        phone: document.getElementById('phone').value,
        location: document.getElementById('location').value,
        linkedin: document.getElementById('linkedin').value,
        github: document.getElementById('github').value,
        target_role: document.getElementById('targetRole').value || 'Software Developer',
        target_industry: document.getElementById('targetIndustry').value,
        skills: state.skills,
        certifications: state.certifications,
        education: state.education.map(e => ({
          institution: e.institution || 'University',
          degree: e.degree || 'Bachelor\'s',
          field: e.field || 'Computer Science',
          start_year: e.start_year || 2021,
          end_year: e.end_year,
          gpa: e.gpa,
          achievements: [],
        })).filter(e => e.institution !== 'University' || state.education.length === 1),
        experience: state.experience.map(e => ({
          company: e.company || '',
          role: e.role || '',
          start_date: e.start_date || '',
          end_date: e.end_date || 'Present',
          description: e.description || '',
          technologies: e.technologies || [],
        })).filter(e => e.company || e.role),
        projects: state.projects.map(p => ({
          name: p.name || 'Project',
          description: p.description || '',
          technologies: p.technologies || [],
          github_url: p.github_url,
          live_url: p.live_url,
          impact: p.impact,
        })).filter(p => p.name !== 'Project' || p.description),
      };
    }

    // ‚îÄ‚îÄ‚îÄ Generate Documents ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function generateDocuments() {
      const btn = document.getElementById('generateBtn');
      btn.disabled = true;

      // Show loading
      const output = document.getElementById('outputContent');
      output.innerHTML = `
    <div class="loading-overlay">
      <div class="spinner"></div>
      <div class="loading-steps" id="loadingSteps">
        <div class="loading-step active" style="animation-delay:0s">üß† Analyzing your profile...</div>
        <div class="loading-step" style="animation-delay:0.4s">üéØ Matching keywords from job description...</div>
        <div class="loading-step" style="animation-delay:0.8s">‚úçÔ∏è Crafting personalized content...</div>
        <div class="loading-step" style="animation-delay:1.2s">‚ö° Optimizing for ATS systems...</div>
        <div class="loading-step" style="animation-delay:1.6s">‚ú® Finalizing documents...</div>
      </div>
    </div>
  `;

      // Animate loading steps
      const steps = output.querySelectorAll('.loading-step');
      let stepIdx = 0;
      const stepTimer = setInterval(() => {
        if (stepIdx > 0) steps[stepIdx - 1]?.classList.replace('active', 'done');
        if (stepIdx < steps.length) steps[stepIdx]?.classList.add('active');
        stepIdx++;
        if (stepIdx > steps.length) clearInterval(stepTimer);
      }, 600);

      const profile = buildProfile();
      const jobDesc = document.getElementById('jobDescription').value;
      const company = document.getElementById('companyName').value;
      const tone = document.getElementById('tone').value;

      // Make sure education has at least one entry
      if (profile.education.length === 0) {
        profile.education = [{ institution: 'Your University', degree: "Bachelor's", field: 'Computer Science', start_year: 2021 }];
      }

      try {
        const response = await fetch(`${API_BASE}/api/generate`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            profile,
            generate_resume: state.options.resume,
            generate_cover_letter: state.options.cover && !!company,
            generate_portfolio: state.options.portfolio,
            job_description: jobDesc || null,
            company_name: company || null,
            tone,
          }),
        });

        clearInterval(stepTimer);

        if (!response.ok) throw new Error('API error: ' + response.status);

        const data = await response.json();
        state.generatedData = data.data;
        renderOutput(data.data);
      } catch (err) {
        // Fallback: generate mock data client-side
        clearInterval(stepTimer);
        const mockData = generateMockData(profile, jobDesc, company, tone);
        state.generatedData = mockData;
        renderOutput(mockData);
      }

      btn.disabled = false;
    }

    // ‚îÄ‚îÄ‚îÄ Mock Data Generator (client-side fallback) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function generateMockData(profile, jobDesc, company, tone) {
      const skillCategories = {
        languages: profile.skills.filter(s => ['Python', 'JavaScript', 'TypeScript', 'Java', 'C++', 'Go', 'Rust', 'Swift', 'Kotlin', 'R'].includes(s)),
        frameworks: profile.skills.filter(s => ['React', 'Next.js', 'Vue', 'Angular', 'FastAPI', 'Django', 'Flask', 'Express', 'TensorFlow', 'PyTorch'].includes(s)),
        databases: profile.skills.filter(s => ['PostgreSQL', 'MySQL', 'MongoDB', 'Redis', 'SQLite'].includes(s)),
        cloud: profile.skills.filter(s => ['AWS', 'Azure', 'GCP', 'Docker', 'Kubernetes'].includes(s)),
        tools: profile.skills.filter(s => ['Git', 'GitHub', 'Jira', 'Figma', 'Linux', 'REST API'].includes(s)),
        other: profile.skills.filter(s => !['Python', 'JavaScript', 'TypeScript', 'Java', 'C++', 'Go', 'React', 'Next.js', 'Vue', 'Angular', 'FastAPI', 'Django', 'Flask', 'TensorFlow', 'PyTorch', 'PostgreSQL', 'MySQL', 'MongoDB', 'Redis', 'AWS', 'Azure', 'GCP', 'Docker', 'Kubernetes', 'Git'].includes(s)),
      };

      const skillsOrg = Object.fromEntries(Object.entries(skillCategories).filter(([, v]) => v.length));

      const targetRole = profile.target_role || 'Software Developer';
      const skillStr = profile.skills.slice(0, 4).join(', ') || 'Python, JavaScript, React';
      const edu = profile.education[0] || {};
      const degree = edu.degree || "Bachelor's";
      const field = edu.field || 'Computer Science';

      const summary = `Results-driven ${targetRole} with a ${degree} in ${field} and strong academic foundation in the ${profile.target_industry} industry. Proficient in ${skillStr}, with a proven track record of delivering impactful solutions. Seeking to leverage technical expertise and problem-solving abilities.`;

      const enhancedExp = (profile.experience || []).map(exp => ({
        ...exp,
        bullets: [
          `Built and maintained ${exp.technologies?.join(', ') || 'key systems'} applications with focus on performance and scalability`,
          `${exp.description?.slice(0, 120) || 'Developed scalable solutions contributing to team goals'} ‚Äî [Add specific metric]`,
          `Collaborated with cross-functional teams using Agile methodologies to deliver features on schedule`,
        ],
      }));

      const enhancedProjects = (profile.projects || []).map((p, i) => ({
        ...p,
        highlight: i < 2,
        relevance_score: 3 - i,
        card_color: ['#b794f6', '#93c5fd', '#c4b5fd', '#a5b4fc', '#7dd3fc'][i % 5],
        category: 'Software Engineering',
        tags: p.technologies?.slice(0, 4) || [],
        generated_impact: `Implemented using ${p.technologies?.length || 3} technologies, demonstrating full-stack capabilities`,
      }));

      const coverLetter = company ? {
        recipient: `Hiring Manager, ${company}`,
        subject: `Application for ${targetRole} Position`,
        paragraphs: [
          `I am writing to express my strong interest in the ${targetRole} position at ${company}. With a ${degree} in ${field} and hands-on experience in ${skillStr}, I am confident in my ability to make a meaningful contribution to your team.`,
          profile.experience?.length > 0
            ? `In my role as ${profile.experience[0].role} at ${profile.experience[0].company}, I developed ${profile.experience[0].description?.slice(0, 120) || 'strong technical skills'}. This experience strengthened my expertise in ${profile.experience[0].technologies?.slice(0, 3).join(', ') || skillStr}.`
            : `Through my academic projects and self-directed learning, I have developed proficiency in ${skillStr}. My coursework has given me a solid theoretical foundation that I am eager to apply in a professional setting.`,
          profile.projects?.length > 0
            ? `One of my key projects, "${profile.projects[0].name}", involved ${profile.projects[0].description?.slice(0, 120) || 'building an innovative solution'}. Built using ${profile.projects[0].technologies?.slice(0, 4).join(', ') || skillStr}, this project demonstrates my ability to deliver end-to-end solutions.`
            : '',
          `I look forward to discussing how my skills align with the ${company} team. I am particularly drawn to ${company}'s work and believe my background in ${profile.skills.slice(0, 2).join(' and ')} would enable me to contribute effectively from day one. Thank you for considering my application.`,
        ].filter(Boolean),
        signature: profile.name,
        word_count: 280,
      } : null;

      const portfolioStats = {
        projects_built: profile.projects?.length || 0,
        technologies: profile.skills?.length || 0,
        years_coding: Math.max(1, profile.experience?.length || 1) + 1,
        certifications: profile.certifications?.length || 0,
      };

      const skillsViz = Object.entries(skillsOrg).map(([cat, skills], i) => ({
        category: cat.charAt(0).toUpperCase() + cat.slice(1),
        skills: skills.slice(0, 5),
        proficiency: Math.max(55, 90 - i * 8),
        count: skills.length,
      }));

      return {
        resume: {
          header: { name: profile.name, email: profile.email, phone: profile.phone, location: profile.location, linkedin: profile.linkedin, github: profile.github },
          summary,
          skills: skillsOrg,
          experience: enhancedExp,
          projects: enhancedProjects,
          education: profile.education,
          certifications: profile.certifications,
        },
        cover_letter: coverLetter,
        portfolio: {
          bio: {
            headline: `${targetRole} & Problem Solver`,
            tagline: `Building impactful solutions with ${profile.skills[0] || 'code'}`,
            about: `Hi, I'm ${profile.name} ‚Äî a ${targetRole} passionate about building impactful software. I hold a ${degree} in ${field} and have built ${profile.projects?.length || 0}+ projects using ${skillStr}. I thrive at the intersection of technical excellence and creative problem-solving.`,
            interests: ['Open Source', 'Tech Innovation', 'AI/ML', 'Cloud Computing'].slice(0, 4),
          },
          featured_projects: enhancedProjects,
          skills_visualization: skillsViz,
          stats: portfolioStats,
          contact: { name: profile.name, email: profile.email, github: profile.github, linkedin: profile.linkedin },
        },
        skills_analysis: {
          total_skills: profile.skills?.length || 0,
          matching_skills: profile.skills?.slice(0, 5) || [],
          skill_gaps: jobDesc ? ['Kubernetes', 'Terraform', 'GraphQL'].slice(0, 3) : [],
          match_percentage: 75,
          top_skills: profile.skills?.slice(0, 8) || [],
          learning_suggestions: ['Consider exploring cloud certifications', 'Add testing frameworks to your skills'],
        },
      };
    }

    // ‚îÄ‚îÄ‚îÄ Render Output ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function renderOutput(data) {
      const output = document.getElementById('outputContent');
      const tab = state.activeTab;

      if (tab === 'resume' && data.resume) {
        output.innerHTML = renderResume(data.resume);
      } else if (tab === 'cover' && data.cover_letter) {
        output.innerHTML = renderCoverLetter(data.cover_letter);
      } else if (tab === 'portfolio' && data.portfolio) {
        output.innerHTML = renderPortfolio(data.portfolio);
      } else if (tab === 'analysis' && data.skills_analysis) {
        output.innerHTML = renderAnalysis(data.skills_analysis);
      } else {
        output.innerHTML = `<div class="empty-state"><div class="empty-icon">‚ÑπÔ∏è</div><div class="empty-title">Not generated</div><div class="empty-sub">Enable this option and regenerate.</div></div>`;
      }
    }

    // ‚îÄ‚îÄ‚îÄ Resume Renderer ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function renderResume(resume) {
      const h = resume.header || {};
      const contactItems = [
        h.email && `<span class="contact-item">üìß ${h.email}</span>`,
        h.phone && `<span class="contact-item">üì± ${h.phone}</span>`,
        h.location && `<span class="contact-item">üìç ${h.location}</span>`,
        h.linkedin && `<span class="contact-item">üîó LinkedIn</span>`,
        h.github && `<span class="contact-item">üíª GitHub</span>`,
      ].filter(Boolean).join('');

      const skillsHtml = Object.entries(resume.skills || {}).map(([cat, skills]) =>
        skills.map(s => `<span class="skill-tag ${cat}">${s}</span>`).join('')
      ).join('');

      const expHtml = (resume.experience || []).map(exp => `
    <div class="exp-item">
      <div class="exp-title-row">
        <div>
          <div class="exp-role">${exp.role || ''}</div>
          <div class="exp-company">${exp.company || ''}</div>
        </div>
        <div class="exp-dates">${exp.start_date || ''} ‚Äî ${exp.end_date || 'Present'}</div>
      </div>
      <ul class="exp-bullets">
        ${(exp.bullets || [exp.description]).filter(Boolean).map(b => `<li>${b}</li>`).join('')}
      </ul>
      ${exp.technologies?.length ? `<div class="exp-techs">${exp.technologies.map(t => `<span class="tech-pill">${t}</span>`).join('')}</div>` : ''}
    </div>
  `).join('');

      const projHtml = (resume.projects || []).map(proj => `
    <div class="proj-item">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <div class="proj-name">${proj.name || ''}</div>
        ${proj.highlight ? '<span class="pill-label pill-success">‚ú¶ Featured</span>' : ''}
      </div>
      <div class="proj-desc">${proj.description || proj.generated_impact || ''}</div>
      <div class="exp-techs">${(proj.technologies || []).map(t => `<span class="tech-pill">${t}</span>`).join('')}</div>
      <div class="proj-links">
        ${proj.github_url ? `<a class="proj-link" href="${proj.github_url}" target="_blank">‚äï GitHub</a>` : ''}
        ${proj.live_url ? `<a class="proj-link" href="${proj.live_url}" target="_blank">‚äû Live Demo</a>` : ''}
      </div>
    </div>
  `).join('');

      const eduHtml = (resume.education || []).map(edu => `
    <div class="edu-item">
      <div class="edu-degree">${edu.degree || ''} in ${edu.field || ''}</div>
      <div class="edu-institution">${edu.institution || ''}</div>
      <div class="edu-meta">${edu.start_year || ''} ‚Äî ${edu.end_year || 'Present'} ${edu.gpa ? '¬∑ GPA: ' + edu.gpa : ''}</div>
    </div>
  `).join('');

      const certHtml = (resume.certifications || []).length ? `
    <div class="resume-section">
      <div class="rs-title">Certifications</div>
      <div class="skills-grid">${(resume.certifications || []).map(c => `<span class="skill-tag other">${c}</span>`).join('')}</div>
    </div>
  ` : '';

      return `
    <div class="export-bar">
      <button class="export-btn" onclick="copyResume()">üìã Copy Text</button>
      <button class="export-btn primary" onclick="downloadResumeDoc()">‚¨á Download Resume</button>
    </div>
    <div class="resume-doc" id="resumeDoc">
      <div class="resume-header-section">
        <div class="resume-name">${h.name || 'Your Name'}</div>
        <div class="resume-target">${document.getElementById('targetRole').value || 'Software Developer'}</div>
        <div class="resume-contact">${contactItems}</div>
      </div>
      <div class="resume-body">
        ${resume.summary ? `<div class="resume-section"><div class="rs-title">Professional Summary</div><div class="rs-summary">${resume.summary}</div></div>` : ''}
        ${skillsHtml ? `<div class="resume-section"><div class="rs-title">Technical Skills</div><div class="skills-grid">${skillsHtml}</div></div>` : ''}
        ${expHtml ? `<div class="resume-section"><div class="rs-title">Work Experience</div>${expHtml}</div>` : ''}
        ${projHtml ? `<div class="resume-section"><div class="rs-title">Projects</div>${projHtml}</div>` : ''}
        ${eduHtml ? `<div class="resume-section"><div class="rs-title">Education</div>${eduHtml}</div>` : ''}
        ${certHtml}
      </div>
    </div>
  `;
    }

    // ‚îÄ‚îÄ‚îÄ Cover Letter Renderer ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function renderCoverLetter(cl) {
      if (!cl) return `<div class="empty-state"><div class="empty-icon">‚úâÔ∏è</div><div class="empty-title">No cover letter generated</div><div class="empty-sub">Enter a company name and regenerate.</div></div>`;

      const paras = (cl.paragraphs || []).filter(Boolean).map(p => `<p class="cl-para">${p}</p>`).join('');

      return `
    <div class="export-bar">
      <button class="export-btn" onclick="copyCoverLetter()">üìã Copy</button>
      <button class="export-btn primary" onclick="window.print()">‚¨á Export</button>
    </div>
    <div class="cover-letter-doc">
      <div class="cl-subject">Cover Letter</div>
      <div class="cl-title">${cl.subject || 'Application Letter'}</div>
      <div style="color:var(--text3); font-size:0.8rem; margin-bottom:1.5rem; font-family:'JetBrains Mono',monospace;">${cl.recipient || ''}</div>
      <div class="divider"></div>
      <br/>
      ${paras}
      <br/>
      <div style="color:var(--text2); font-size:0.8rem;">Sincerely,</div>
      <div class="cl-sig">${cl.signature || 'Your Name'}</div>
      <br/>
      <div style="color:var(--text3); font-size:0.75rem; font-family:'JetBrains Mono',monospace;">${cl.word_count || 0} words ¬∑ AI-optimized</div>
    </div>
  `;
    }

    // ‚îÄ‚îÄ‚îÄ Portfolio Renderer ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function renderPortfolio(portfolio) {
      if (!portfolio) return '';
      state.latestPortfolio = portfolio;

      const bio = portfolio.bio || {};
      const stats = portfolio.stats || {};

      const statsHtml = `
    <div class="portfolio-stats">
      <div class="stat-card"><div class="stat-num">${stats.projects_built || 0}</div><div class="stat-label">Projects Built</div></div>
      <div class="stat-card"><div class="stat-num">${stats.technologies || 0}</div><div class="stat-label">Technologies</div></div>
      <div class="stat-card"><div class="stat-num">${stats.years_coding || 1}+</div><div class="stat-label">Years Coding</div></div>
      <div class="stat-card"><div class="stat-num">${stats.certifications || 0}</div><div class="stat-label">Certifications</div></div>
    </div>
  `;

      const projectCards = (portfolio.featured_projects || []).slice(0, 6).map(proj => `
    <div class="portfolio-proj-card" style="--card-color:${proj.card_color || '#b794f6'}">
      <div class="proj-card-cat">${proj.category || 'Engineering'}</div>
      <div class="proj-card-name">${proj.name || ''}</div>
      <div class="proj-card-desc">${(proj.description || '').slice(0, 120)}${(proj.description || '').length > 120 ? '...' : ''}</div>
      <div class="proj-card-tags">${(proj.tags || proj.technologies || []).slice(0, 4).map(t => `<span class="proj-tag">${t}</span>`).join('')}</div>
    </div>
  `).join('');

      const skillBars = (portfolio.skills_visualization || []).map(s => `
    <div class="skill-bar-item">
      <div class="skill-bar-header">
        <span>${s.category} <span style="color:var(--text3);font-size:0.7rem;">(${s.skills?.slice(0, 3).join(', ') || ''})</span></span>
        <span style="color:var(--accent2); font-family:'JetBrains Mono',monospace; font-size:0.8rem;">${s.proficiency}%</span>
      </div>
      <div class="skill-bar-track"><div class="skill-bar-fill" style="width:${s.proficiency}%"></div></div>
    </div>
  `).join('');

      return `
    <div class="export-bar">
      <button class="export-btn" onclick="openPortfolioFullPage()">‚Üó View Full Page</button>
      <button class="export-btn primary" onclick="downloadPortfolioZip()">‚¨á Download Portfolio ZIP</button>
    </div>
    <div class="portfolio-preview">
      <div class="portfolio-hero">
        <div class="portfolio-name">${bio.headline || 'Developer'}</div>
        <div class="portfolio-tagline">${bio.tagline || ''}</div>
        <div style="font-size:0.875rem; color:var(--text2); max-width:600px; margin:0 auto; line-height:1.7;">${bio.about || ''}</div>
        <div style="display:flex; justify-content:center; gap:0.5rem; margin-top:1rem; flex-wrap:wrap;">
          ${(bio.interests || []).map(i => `<span class="pill-label pill-success">‚óé ${i}</span>`).join('')}
        </div>
      </div>
      ${statsHtml}
      ${projectCards ? `<h3>Featured Projects</h3><div class="projects-grid">${projectCards}</div>` : ''}
      ${skillBars ? `<div class="skills-section"><h3 style="margin-bottom:1rem;">Skills Overview</h3><div class="skills-bars">${skillBars}</div></div>` : ''}
    </div>
  `;
    }

    // ‚îÄ‚îÄ‚îÄ Analysis Renderer ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function renderAnalysis(analysis) {
      if (!analysis) return '';

      const matchPct = analysis.match_percentage || 0;
      const color = matchPct >= 70 ? '#34d399' : matchPct >= 50 ? '#fbbf24' : '#f87171';

      const matchedPills = (analysis.matching_skills || []).map(s => `<span class="kw-matched">‚úì ${s}</span>`).join('');
      const gapPills = (analysis.skill_gaps || []).map(s => `<span class="kw-missing">‚úó ${s}</span>`).join('');
      const topSkills = (analysis.top_skills || []).map(s => `<span class="kw-matched">‚ö° ${s}</span>`).join('');
      const suggestions = (analysis.learning_suggestions || []).map(s => `<div class="rec-item"><span class="rec-icon">üí°</span>${s}</div>`).join('');

      return `
    <div class="ats-panel">
      <div class="ats-score-ring">
        <div class="score-circle" style="border-color:${color}">
          <div class="score-num" style="color:${color}">${Math.round(matchPct)}%</div>
          <div class="score-label">Match</div>
        </div>
        <div style="font-size:0.875rem; color:var(--text2);">${matchPct >= 70 ? '‚úÖ Strong alignment with target role' : matchPct >= 50 ? '‚ö†Ô∏è Good match ‚Äî address gaps' : 'üî¥ Skill development needed'}</div>
      </div>
      <div class="ats-breakdown">
        <div class="breakdown-card"><div class="bd-label">Total Skills</div><div class="bd-value">${analysis.total_skills}</div></div>
        <div class="breakdown-card"><div class="bd-label">Matching Skills</div><div class="bd-value" style="color:var(--success)">${analysis.matching_skills?.length || 0}</div></div>
        <div class="breakdown-card"><div class="bd-label">Skill Gaps</div><div class="bd-value" style="color:var(--danger)">${analysis.skill_gaps?.length || 0}</div></div>
        <div class="breakdown-card"><div class="bd-label">Match Score</div><div class="bd-value" style="color:${color}">${Math.round(matchPct)}%</div></div>
      </div>
      ${topSkills ? `<h3>Your Top Skills</h3><div class="keyword-pills">${topSkills}</div>` : ''}
      ${matchedPills ? `<h3>Matching JD Skills</h3><div class="keyword-pills">${matchedPills}</div>` : ''}
      ${gapPills ? `<h3>Skill Gaps</h3><div class="keyword-pills">${gapPills}</div>` : ''}
      ${suggestions ? `<h3>Learning Recommendations</h3><div class="recs-list">${suggestions}</div>` : ''}
    </div>
  `;
    }

    // ‚îÄ‚îÄ‚îÄ ATS Check ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    async function runATSCheck() {
      const resume = document.getElementById('atsResume').value;
      const jd = document.getElementById('atsJD').value;
      const result = document.getElementById('atsResult');

      if (!resume || !jd) {
        result.innerHTML = '<div class="rec-item"><span class="rec-icon">‚ö†Ô∏è</span>Please enter both resume text and job description.</div>';
        return;
      }

      result.innerHTML = '<div class="loading-overlay" style="height:80px;"><div class="spinner"></div></div>';

      try {
        const response = await fetch(`${API_BASE}/api/ats-score`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ resume_text: resume, job_description: jd }),
        });

        if (!response.ok) throw new Error();

        const data = await response.json();
        const score = data.data;
        renderATSResult(result, score);
      } catch {
        // Mock ATS result
        const mockScore = {
          overall_score: 62,
          breakdown: { keyword_match: 58, format_score: 80, action_verbs: 60, quantification: 30 },
          matched_keywords: ['Python', 'React', 'API'],
          missing_keywords: ['Docker', 'Kubernetes', 'TypeScript'],
          recommendations: [
            'Add Docker and Kubernetes experience',
            'Quantify achievements with numbers (e.g., improved performance by 40%)',
            'Use more action verbs (Led, Built, Achieved)',
            'Add LinkedIn profile to resume',
          ]
        };
        renderATSResult(result, mockScore);
      }
    }

    function renderATSResult(container, score) {
      const color = score.overall_score >= 70 ? '#34d399' : score.overall_score >= 50 ? '#fbbf24' : '#f87171';
      container.innerHTML = `
    <div class="ats-panel">
      <div class="ats-score-ring">
        <div class="score-circle" style="border-color:${color}">
          <div class="score-num" style="color:${color}">${score.overall_score}</div>
          <div class="score-label">ATS Score</div>
        </div>
      </div>
      <div class="ats-breakdown">
        ${Object.entries(score.breakdown || {}).map(([k, v]) => `
          <div class="breakdown-card">
            <div class="bd-label">${k.replace(/_/g, ' ')}</div>
            <div class="bd-value" style="color:${v >= 70 ? '#34d399' : v >= 50 ? '#fbbf24' : '#f87171'}">${Math.round(v)}%</div>
          </div>
        `).join('')}
      </div>
      ${score.matched_keywords?.length ? `<h3>Matched Keywords</h3><div class="keyword-pills">${score.matched_keywords.map(k => `<span class="kw-matched">‚úì ${k}</span>`).join('')}</div>` : ''}
      ${score.missing_keywords?.length ? `<h3>Missing Keywords</h3><div class="keyword-pills">${score.missing_keywords.map(k => `<span class="kw-missing">‚úó ${k}</span>`).join('')}</div>` : ''}
      ${score.recommendations?.length ? `<h3>Recommendations</h3><div class="recs-list">${score.recommendations.map(r => `<div class="rec-item"><span class="rec-icon">üí°</span>${r}</div>`).join('')}</div>` : ''}
    </div>
  `;
    }

    // ‚îÄ‚îÄ‚îÄ Export Utils ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
    function copyResume() {
      const el = document.getElementById('resumeDoc');
      navigator.clipboard?.writeText(el?.innerText || '').then(() => alert('Resume copied to clipboard!'));
    }
    function copyCoverLetter() {
      const el = document.querySelector('.cover-letter-doc');
      navigator.clipboard?.writeText(el?.innerText || '').then(() => alert('Cover letter copied!'));
    }

    function sanitizeFilename(value) {
      return (value || 'resume').toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');
    }

    function downloadResumeDoc() {
      const resumeEl = document.getElementById('resumeDoc');
      if (!resumeEl) {
        alert('Generate a resume first.');
        return;
      }

      const name = resumeEl.querySelector('.resume-name')?.innerText?.trim() || 'Candidate';
      const docHtml = `
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>${name} Resume</title>
  <style>
    body { font-family: Calibri, Arial, sans-serif; color: #111827; margin: 28px; line-height: 1.45; }
    .resume-doc { max-width: 860px; margin: 0 auto; }
    .resume-header-section { border-bottom: 2px solid #0ea5e9; padding-bottom: 14px; margin-bottom: 16px; }
    .resume-name { font-size: 30px; font-weight: 700; color: #0f172a; margin-bottom: 4px; }
    .resume-target { font-size: 14px; color: #0369a1; margin-bottom: 8px; }
    .resume-contact { font-size: 12px; color: #334155; display: flex; flex-wrap: wrap; gap: 10px; }
    .resume-body { padding-top: 6px; }
    .rs-title { font-size: 12px; letter-spacing: 0.12em; text-transform: uppercase; color: #0c4a6e; border-bottom: 1px solid #bae6fd; padding-bottom: 4px; margin: 14px 0 10px; font-weight: 700; }
    .rs-summary, .proj-desc, .edu-institution { font-size: 13px; color: #1f2937; }
    .skills-grid, .exp-techs { display: flex; flex-wrap: wrap; gap: 6px; }
    .skill-tag, .tech-pill { border: 1px solid #bae6fd; background: #f0f9ff; color: #075985; border-radius: 4px; padding: 2px 7px; font-size: 11px; }
    .exp-title-row { display: flex; justify-content: space-between; gap: 10px; align-items: baseline; }
    .exp-role, .proj-name, .edu-degree { font-size: 14px; font-weight: 700; color: #0f172a; }
    .exp-company { font-size: 13px; color: #0369a1; }
    .exp-dates, .edu-meta { font-size: 11px; color: #64748b; }
    .exp-bullets { margin: 6px 0 0 0; padding-left: 18px; }
    .exp-bullets li { margin-bottom: 4px; font-size: 13px; color: #1f2937; }
    .proj-links { margin-top: 6px; display: flex; gap: 10px; }
    .proj-link { color: #0c4a6e; text-decoration: none; font-size: 11px; }
  </style>
</head>
<body>
  <div class="resume-doc">${resumeEl.innerHTML}</div>
</body>
</html>`;

      const blob = new Blob([docHtml], { type: 'application/msword' });
      const link = document.createElement('a');
      const objectUrl = URL.createObjectURL(blob);
      link.href = objectUrl;
      link.download = `${sanitizeFilename(name)}-buildmyfolio-resume.doc`;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      setTimeout(() => URL.revokeObjectURL(objectUrl), 1000);
    }

    function getPortfolioForExport() {
      const portfolio = state.latestPortfolio || state.generatedData?.portfolio;
      if (!portfolio) {
        alert('Generate your portfolio first.');
        return null;
      }
      return portfolio;
    }

    function escapeHtml(value) {
      return String(value ?? '').replace(/[&<>"']/g, ch => (
        ch === '&' ? '&amp;' :
          ch === '<' ? '&lt;' :
            ch === '>' ? '&gt;' :
              ch === '"' ? '&quot;' : '&#39;'
      ));
    }

    function normalizeUrl(url) {
      const raw = String(url || '').trim();
      if (!raw || /^javascript:/i.test(raw)) return '';
      return /^https?:\/\//i.test(raw) ? raw : `https://${raw}`;
    }

function buildPortfolioStylesCss() {
      return `:root{
  --bg:#06060d;
  --surface:#0f0d1b;
  --surface2:#17142a;
  --text:#ecebff;
  --muted:#b6afd7;
  --accent:#b794f6;
  --accent2:#93c5fd;
  --border:#2f2a4a;
}
*{box-sizing:border-box}
html,body{margin:0;padding:0}
body{
  font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;
  background:radial-gradient(circle at 15% 15%, rgba(183,148,246,.16), transparent 40%), radial-gradient(circle at 85% 80%, rgba(147,197,253,.12), transparent 45%), var(--bg);
  color:var(--text);
  line-height:1.6;
}
a{color:inherit}
.site{max-width:1120px;margin:0 auto;padding:2rem 1.1rem 4rem}
.hero{
  border:1px solid var(--border);
  background:linear-gradient(140deg, rgba(183,148,246,.2), rgba(147,197,253,.08));
  border-radius:20px;
  padding:3rem 1.6rem;
  text-align:center;
}
.name{font-size:clamp(2rem,6vw,3.6rem);font-weight:800;letter-spacing:-.03em;margin:0}
.tagline{font-size:1.1rem;color:#bfdbfe;margin:.6rem 0 1rem}
.about{max-width:760px;margin:0 auto;color:var(--muted)}
.chips{margin-top:1rem;display:flex;justify-content:center;flex-wrap:wrap;gap:.5rem}
.chip{
  padding:.25rem .7rem;
  border-radius:999px;
  border:1px solid rgba(183,148,246,.4);
  background:rgba(183,148,246,.14);
  font-size:.78rem;
}
.stats{
  margin-top:1.6rem;
  display:grid;
  grid-template-columns:repeat(4,minmax(0,1fr));
  gap:.8rem;
}
.card{
  background:var(--surface2);
  border:1px solid var(--border);
  border-radius:14px;
  padding:1rem;
}
.stat-num{font-size:1.8rem;font-weight:800;background:linear-gradient(130deg,var(--accent),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.stat-label{font-size:.75rem;color:var(--muted)}
.section-title{margin:2.2rem 0 .8rem;font-size:1rem;letter-spacing:.08em;text-transform:uppercase;color:#d8ccff}
.projects{
  display:grid;
  grid-template-columns:repeat(2,minmax(0,1fr));
  gap:1rem;
}
.project{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:14px;
  padding:1.1rem;
  position:relative;
  overflow:hidden;
}
.project::before{
  content:"";
  position:absolute;
  left:0;right:0;top:0;height:3px;
  background:var(--card-color, var(--accent));
}
.project-name{margin:.2rem 0 .4rem;font-size:1rem;font-weight:700}
.project-cat{font-size:.7rem;letter-spacing:.08em;text-transform:uppercase;color:var(--muted)}
.project-desc{font-size:.9rem;color:#d8d7f1}
.tags{display:flex;flex-wrap:wrap;gap:.35rem;margin-top:.7rem}
.tag{
  border:1px solid rgba(147,197,253,.34);
  background:rgba(147,197,253,.1);
  color:#cbe4ff;
  border-radius:6px;
  font-size:.72rem;
  padding:.12rem .45rem;
}
.links{display:flex;gap:.7rem;flex-wrap:wrap;margin-top:.7rem}
.link{
  text-decoration:none;
  font-size:.75rem;
  color:#bedbff;
}
.skills-wrap{
  background:var(--surface);
  border:1px solid var(--border);
  border-radius:14px;
  padding:1rem;
}
.skill-item{margin-bottom:.9rem}
.skill-head{display:flex;justify-content:space-between;font-size:.85rem;margin-bottom:.3rem}
.skill-track{height:8px;border-radius:999px;background:#2b2744;overflow:hidden}
.skill-fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2))}
.contact{
  margin-top:2.2rem;
  border-top:1px solid var(--border);
  padding-top:1.2rem;
  color:var(--muted);
  display:flex;
  justify-content:space-between;
  gap:1rem;
  flex-wrap:wrap;
}
.contact-links{display:flex;gap:.9rem;flex-wrap:wrap}
.contact-links a{text-decoration:none;color:#c7ddff}
[data-reveal]{opacity:0;transform:translateY(14px);transition:all .55s ease}
[data-reveal].show{opacity:1;transform:none}
@media (max-width:900px){
  .stats{grid-template-columns:repeat(2,minmax(0,1fr))}
  .projects{grid-template-columns:1fr}
}
@media (max-width:560px){
  .site{padding:1.2rem .8rem 2rem}
  .hero{padding:2rem 1rem}
  .stats{grid-template-columns:1fr}
}`;
    }

    function buildPortfolioScriptJs() {
      return `document.querySelectorAll('[data-reveal]').forEach((el, idx) => {
  setTimeout(() => el.classList.add('show'), 60 * (idx + 1));
});
const yearEl = document.getElementById('portfolioYear');
if (yearEl) yearEl.textContent = new Date().getFullYear();`;
    }

    function buildPortfolioSiteContent(portfolio) {
      const bio = portfolio.bio || {};
      const stats = portfolio.stats || {};
      const contact = portfolio.contact || {};
      const projects = (portfolio.featured_projects || []).slice(0, 9);
      const skills = (portfolio.skills_visualization || []).slice(0, 8);
      const interests = (bio.interests || []).slice(0, 8);

      const displayName = escapeHtml(bio.headline || contact.name || 'Developer Portfolio');
      const tagline = escapeHtml(bio.tagline || 'AI-focused builder and engineer');
      const about = escapeHtml(bio.about || 'A portfolio generated with BuildMyFolio.');

      const statsHtml = [
        { label: 'Projects Built', value: Number(stats.projects_built) || projects.length || 0 },
        { label: 'Technologies', value: Number(stats.technologies) || 0 },
        { label: 'Years Coding', value: `${Number(stats.years_coding) || 1}+` },
        { label: 'Certifications', value: Number(stats.certifications) || 0 },
      ].map(item => `
    <article class="card" data-reveal>
      <div class="stat-num">${escapeHtml(item.value)}</div>
      <div class="stat-label">${escapeHtml(item.label)}</div>
    </article>
  `).join('');

      const interestsHtml = interests.map(i => `<span class="chip">${escapeHtml(i)}</span>`).join('');

      const projectsHtml = projects.map((proj, idx) => {
        const tags = (proj.tags || proj.technologies || []).slice(0, 6);
        const liveUrl = normalizeUrl(proj.live_url);
        const githubUrl = normalizeUrl(proj.github_url);
        const links = [
          liveUrl ? `<a class="link" href="${escapeHtml(liveUrl)}" target="_blank" rel="noopener noreferrer">Live Demo ‚Üó</a>` : '',
          githubUrl ? `<a class="link" href="${escapeHtml(githubUrl)}" target="_blank" rel="noopener noreferrer">GitHub ‚Üó</a>` : '',
        ].filter(Boolean).join('');
        const cardColor = escapeHtml(proj.card_color || ['#b794f6', '#93c5fd', '#c4b5fd', '#a5b4fc'][idx % 4]);
        return `
      <article class="project" style="--card-color:${cardColor}" data-reveal>
        <div class="project-cat">${escapeHtml(proj.category || 'Engineering')}</div>
        <h3 class="project-name">${escapeHtml(proj.name || 'Project')}</h3>
        <p class="project-desc">${escapeHtml(proj.description || 'Project details not available.')}</p>
        <div class="tags">${tags.map(t => `<span class="tag">${escapeHtml(t)}</span>`).join('')}</div>
        ${links ? `<div class="links">${links}</div>` : ''}
      </article>
    `;
      }).join('');

      const skillsHtml = skills.map(skill => {
        const pct = Math.max(0, Math.min(100, Number(skill.proficiency) || 0));
        const skillNames = (skill.skills || []).slice(0, 3).map(escapeHtml).join(', ');
        return `
      <div class="skill-item" data-reveal>
        <div class="skill-head">
          <span>${escapeHtml(skill.category || 'Skill')} ${skillNames ? `<span style="color:#6fa6be;font-size:.75rem;">(${skillNames})</span>` : ''}</span>
          <strong>${pct}%</strong>
        </div>
        <div class="skill-track"><div class="skill-fill" style="width:${pct}%"></div></div>
      </div>
    `;
      }).join('');

      const contactLinks = [
        contact.email ? `<a href="mailto:${escapeHtml(contact.email)}">${escapeHtml(contact.email)}</a>` : '',
        normalizeUrl(contact.github) ? `<a href="${escapeHtml(normalizeUrl(contact.github))}" target="_blank" rel="noopener noreferrer">GitHub</a>` : '',
        normalizeUrl(contact.linkedin) ? `<a href="${escapeHtml(normalizeUrl(contact.linkedin))}" target="_blank" rel="noopener noreferrer">LinkedIn</a>` : '',
      ].filter(Boolean).join('');

      return `
<main class="site">
  <section class="hero" data-reveal>
    <h1 class="name">${displayName}</h1>
    <p class="tagline">${tagline}</p>
    <p class="about">${about}</p>
    ${interestsHtml ? `<div class="chips">${interestsHtml}</div>` : ''}
    <section class="stats">${statsHtml}</section>
  </section>

  ${projectsHtml ? `<h2 class="section-title">Featured Projects</h2><section class="projects">${projectsHtml}</section>` : ''}
  ${skillsHtml ? `<h2 class="section-title">Skills Overview</h2><section class="skills-wrap">${skillsHtml}</section>` : ''}

  <footer class="contact" data-reveal>
    <div>Built with BuildMyFolio</div>
    <div class="contact-links">${contactLinks}</div>
    <div>&copy; <span id="portfolioYear"></span> ${displayName}</div>
  </footer>
</main>`;
    }

    function buildPortfolioIndexHtml(portfolio) {
      return `<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>${escapeHtml((portfolio.bio || {}).headline || 'Portfolio')}</title>
  <meta name="description" content="Portfolio site generated by BuildMyFolio" />
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
${buildPortfolioSiteContent(portfolio)}
<script src="./script.js"><\/script>
</body>

</html>`;
}

function buildPortfolioReadme(portfolio) {
const name = escapeHtml((portfolio.bio || {}).headline || 'Portfolio');
return `# ${name} Portfolio

This portfolio was generated by BuildMyFolio and is ready to deploy on GitHub Pages.

## Files
- \`index.html\`
- \`styles.css\`
- \`script.js\`

## Deploy On GitHub
1. Create a new GitHub repository.
2. Upload all files from this folder to the repository root.
3. Open repository settings.
4. Go to **Pages**.
5. Set source to **Deploy from a branch**.
6. Choose branch **main** and folder **/(root)**.
7. Save and wait for the deployment URL.

## Local Preview
Open \`index.html\` directly in a browser or serve with:

\`\`\`bash
python -m http.server 5500
\`\`\`
`;
}

function openPortfolioFullPage() {
const portfolio = getPortfolioForExport();
if (!portfolio) return;

const html = `
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>${escapeHtml((portfolio.bio || {}).headline || 'Portfolio')}</title>
  <style>${buildPortfolioStylesCss()}</style>
</head>

<body>
  ${buildPortfolioSiteContent(portfolio)}
  <script>${buildPortfolioScriptJs()}<\/script>
</body>

</html>`;

const popup = window.open('', '_blank');
if (!popup) {
alert('Please allow popups to view the full-page portfolio.');
return;
}
popup.document.open();
popup.document.write(html);
popup.document.close();
}

async function downloadPortfolioZip() {
const portfolio = getPortfolioForExport();
if (!portfolio) return;
if (typeof JSZip === 'undefined') {
alert('ZIP library failed to load. Please check internet and try again.');
return;
}

const rootName = `${sanitizeFilename((portfolio.bio || {}).headline || 'portfolio-site')}-site`;
const zip = new JSZip();
const folder = zip.folder(rootName);
if (!folder) {
alert('Unable to create zip package.');
return;
}

folder.file('index.html', buildPortfolioIndexHtml(portfolio));
folder.file('styles.css', buildPortfolioStylesCss());
folder.file('script.js', buildPortfolioScriptJs());
folder.file('README.md', buildPortfolioReadme(portfolio));
folder.file('.nojekyll', '');
folder.file('.gitignore', '.DS_Store\n');

const blob = await zip.generateAsync({ type: 'blob' });
const link = document.createElement('a');
const objectUrl = URL.createObjectURL(blob);
link.href = objectUrl;
link.download = `${rootName}.zip`;
document.body.appendChild(link);
link.click();
document.body.removeChild(link);
setTimeout(() => URL.revokeObjectURL(objectUrl), 1000);
}

// ‚îÄ‚îÄ‚îÄ Load Sample Data ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function loadSampleData() {
  document.getElementById('name').value = 'Priya Sharma';
  document.getElementById('email').value = 'priya.sharma@email.com';
  document.getElementById('phone').value = '+91 9876543210';
  document.getElementById('location').value = 'Hyderabad, India';
  document.getElementById('linkedin').value = 'linkedin.com/in/priya-sharma';
  document.getElementById('github').value = 'github.com/priya-sharma';
  document.getElementById('targetRole').value = 'Full Stack Developer';
  document.getElementById('companyName').value = 'Google';
  document.getElementById('jobDescription').value = 'We are looking for a Full Stack Developer with expertise in React, Python, and cloud services. Experience with Docker, REST APIs, and PostgreSQL required. Knowledge of machine learning is a plus.';

  // Add sample skills
  const skills = ['Python', 'React', 'JavaScript', 'FastAPI', 'PostgreSQL', 'Docker', 'Machine Learning', 'Git'];
  skills.forEach(s => {
    state.skills.push(s);
    renderTag('skillsContainer', 'skills', s);
  });

  // Add education
  addEducation();
  const eduId = state.education[0].id;
  state.education[0] = { ...state.education[0], institution: 'IIT Hyderabad', degree: 'B.Tech', field: 'Computer Science', start_year: 2021, end_year: 2025, gpa: 8.7 };
  const eduEl = document.getElementById('edu-' + eduId);
  if (eduEl) {
    eduEl.querySelectorAll('input')[0].value = 'IIT Hyderabad';
    eduEl.querySelectorAll('input')[1].value = 'B.Tech';
    eduEl.querySelectorAll('input')[2].value = 'Computer Science';
    eduEl.querySelectorAll('input')[3].value = '8.7';
    eduEl.querySelectorAll('input')[4].value = '2021';
    eduEl.querySelectorAll('input')[5].value = '2025';
  }

  // Add experience
  addExperience();
  const expId = state.experience[0].id;
  state.experience[0] = { ...state.experience[0], company: 'TechStartup', role: 'Software Intern', start_date: 'May 2024', end_date: 'Aug 2024', description: 'Built REST APIs using FastAPI and deployed to AWS. Improved API response time by 40% through Redis caching. Collaborated with 5-member team using Agile methodology.', technologies: ['Python', 'FastAPI', 'AWS', 'Redis', 'PostgreSQL'] };

  // Add project
  addProject();
  const projId = state.projects[0].id;
  state.projects[0] = { ...state.projects[0], name: 'BuildMyFolio Assistant', description: 'AI-powered career document builder using NLP and machine learning. Analyzes job descriptions and generates tailored resumes with ATS optimization.', technologies: ['Python', 'React', 'FastAPI', 'TensorFlow', 'PostgreSQL'], github_url: 'github.com/priya-sharma/buildmyfolio', impact: 'Used by 200+ students, improved interview callback rate by 35%' };
}

// Auto-load sample data for demo
setTimeout(loadSampleData, 100);
</script>
</body>

</html>
